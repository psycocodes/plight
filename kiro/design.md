# Design: Plight SaaS2

## High-Level Flow
Wallet -> Fetch on-chain data -> Compute behavior -> Sign attestation -> Generate ZK proof -> Verify on-chain.

## Components

### Backend (Aggregator Engine)
- **Responsibilities:**
  - Fetch data from Aave and Compound subgraphs/RPCs.
  - Compute behavior metrics (e.g., liquidation count).
  - Sign an attestation of the computed metrics using a private key.

### ZK Layer
- **Circuit:** Circom circuit to prove:
  - The user possesses a valid attestation signed by the backend.
  - The metrics in the attestation meet the required threshold (e.g., liquidations == 0).
- **Proof Generation:** SnarkJS running on the client-side.
- **Verifier:** Solidity contract generated by SnarkJS to verify proofs on-chain.

### Frontend
- **Tech Stack:** React + Wagmi.
- **Features:**
  - Wallet connection.
  - Eligibility check UI.
  - Proof generation and submission.

### Smart Contract
- **Contract:** `PlightEligibility.sol`
- **Function:** `isEligible(address user, bytes proof, uint[] publicSignals)` returns `bool`.

## SaaS2 Layer
- **Dashboard:** Web interface for users to interact with the system.
- **REST API:** Endpoints for protocols to query eligibility status off-chain if needed.
